@if (userData$ | async; as user) {
	<mat-card class="profile-card">
		<div class="profile-header">
			<img [src]="user.photoURL" alt="Profilbild" class="avatar" />
			<div class="profile-info">
				<h2>{{ user.username }}</h2>

				@if (user.role) {
					<div class="role-chip">
						<mat-chip color="primary">{{ user.role | titlecase }}</mat-chip>
					</div>
				}

				@if (user.teams?.length) {
					<div class="teams">
						<mat-chip>
							@for (team of user.teams; track team) {
								<mat-chip color="accent">{{ team }}</mat-chip>
							}
						</mat-chip>
					</div>
				}

				<div class="profile-meta">
					@if (user.position) {
						<span>{{ user.position }}</span>
					}
					@if (user.department) {
						<span>Â· {{ user.department }}</span>
					}
				</div>
			</div>

			<div class="profile-actions">
				@if (user.socialLinks?.linkedin) {
					<a [href]="user.socialLinks?.linkedin" matTooltip="LinkedIn" target="_blank">
						<mat-icon>linkedin</mat-icon>
					</a>
				}
				@if (user.socialLinks?.twitter) {
					<a [href]="user.socialLinks?.twitter" matTooltip="Twitter" target="_blank">
						<mat-icon>twitter</mat-icon>
					</a>
				}
				@if (user.socialLinks?.github) {
					<a [href]="user.socialLinks?.github" matTooltip="GitHub" target="_blank">
						<mat-icon>code</mat-icon>
					</a>
				}
			</div>
		</div>

		<mat-divider></mat-divider>

		<div class="profile-details">
			<div class="detail-row">
				<mat-icon>mail</mat-icon>
				<span>{{ user.email }}</span>
				@if (user.emailVerified) {
					<mat-icon color="primary" matTooltip="E-Mail verifiziert">verified</mat-icon>
				}
			</div>

			@if (user.phone) {
				<div class="detail-row">
					<mat-icon>phone</mat-icon>
					<span>{{ user.phone }}</span>
				</div>
			}

			@if (user.address) {
				<div class="detail-row">
					<mat-icon>location_on</mat-icon>
					<span>
            {{ user.address.street }}, {{ user.address.postalCode }} {{ user.address.city }}, {{ user.address.country }}
          </span>
				</div>
			}

			@if (user.birthday) {
				<div class="detail-row">
					<mat-icon>cake</mat-icon>
					<span>{{ user.birthday | date }}</span>
				</div>
			}

			<div class="detail-row">
				<mat-icon>vpn_key</mat-icon>
				<span>{{ user.uid }}</span>
			</div>

			@if (user.UserMetadata?.creationTime) {
				<div class="detail-row">
					<mat-icon>calendar_today</mat-icon>
					<span>Erstellt: {{ user.UserMetadata.creationTime | date }}</span>
				</div>
			}

			@if (user.UserMetadata?.lastSignInTime) {
				<div class="detail-row">
					<mat-icon>login</mat-icon>
					<span>Letzter Login: {{ user.UserMetadata.lastSignInTime | date }}</span>
				</div>
			}

			@if (user.permissions?.length) {
				<div class="detail-row">
					<mat-icon>lock</mat-icon>
					<span>Berechtigungen:</span>
					<mat-chip>
						@for (perm of user.permissions; track perm) {
							<mat-chip>{{ perm }}</mat-chip>
						}
					</mat-chip>
				</div>
			}

			@if (user.assignedCustomers?.length) {
				<div class="detail-row">
					<mat-icon>group</mat-icon>
					<span>Kunden: {{ user.assignedCustomers?.length }}</span>
				</div>
			}

			@if (user.openTasks) {
				<div class="detail-row">
					<mat-icon>assignment</mat-icon>
					<span>Offene Aufgaben: {{ user.openTasks }}</span>
				</div>
			}

			@if (user.settings) {
				<div class="detail-row">
					<mat-icon>settings</mat-icon>
					<span>
            {{ user.settings.language }},
            Benachrichtigungen: {{ user.settings.notifications ? 'an' : 'aus' }},
            Theme: {{ user.settings.theme }}
          </span>
				</div>
			}

			@if (user.notes) {
				<div class="detail-row">
					<mat-icon>note</mat-icon>
					<span>{{ user.notes }}</span>
				</div>
			}
		</div>
	</mat-card>
} @else {
	<div class="profile-loading">
		<mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
	</div>
}
